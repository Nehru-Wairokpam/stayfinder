{% extends 'base.html' %} {% block content %}

<div class="container">
  <h2 class="text-center mt-3 mb-4">{{hotel_details.hotel_name }}</h2>

  <section title="Hotel Details">
    <div class="row g-3">
      <!-- Main Hotel Image -->
      <div class="col-lg-5">
        <img
          src="{{hotelDetails.hotel_image.url}}"
          class="img-fluid w-100"
          style="border-radius: 10px; max-height: 350px; object-fit: cover"
        />
      </div>

      <!-- Three smaller Hotel View Images (stacked vertically) -->
      <div class="col-lg-2">
        <div class="d-flex flex-column h-100 justify-content-between">
          <div class="mb-2">
            <img
              src="{{hotelDetails.hotel_view1.url}}"
              class="img-fluid"
              style="
                width: 100%;
                height: 110px;
                object-fit: cover;
                border-radius: 2px;
              "
            />
          </div>
          <div class="mb-2">
            <img
              src="{{hotelDetails.hotel_view2.url}}"
              class="img-fluid"
              style="
                width: 100%;
                height: 110px;
                object-fit: cover;
                border-radius: 2px;
              "
            />
          </div>
          <div>
            <img
              src="{{hotelDetails.hotel_view3.url}}"
              class="img-fluid"
              style="
                width: 100%;
                height: 110px;
                object-fit: cover;
                border-radius: 2px;
              "
            />
          </div>
        </div>
      </div>

      <!-- Hotel Details (Hotel Name and Location) -->
      <div class="col-lg-4" style="margin-left: 80px">
        <div
          class="card shadow-sm border-0 h-100"
          style="
            border-radius: 10px;
            background-color: rgb(238, 232, 220);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 40px;
          "
        >
          <div class="card-body text-start d-flex flex-column">
            <div class="d-flex mb-3">
              <strong class="me-5">Hotel Name:</strong>
              <span>{{hotelDetails.hotel_name}}</span>
            </div>
            <div class="d-flex mb-3">
              <strong class="me-5">Location:</strong>
              <span>{{hotelDetails.location}}</span>
            </div>
            <div class="d-flex mb-3">
              <strong class="me-5">Phone Number:</strong>
              <span>{{hotelDetails.phone_number}}</span>
            </div>
            <div class="d-flex">
              <strong class="me-5">Email:</strong>
              <span>{{hotelDetails.email}}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <hr />


  <section title="Rooms" style="padding: 20px; background-color: #f5f5f5; border-radius: 10px;">
    <div class="row mt-3">
      <div class="d-flex justify-content-between align-items-center mt-5 mb-4" style="flex-wrap: wrap; gap: 10px;">
        <div>
          <h3 style="color: #333; font-weight: bold;">Book Your Stay: Available Rooms</h3>
        </div>
      
        <div style="display: flex; gap: 20px;">
          <!-- Filter Price block -->
          <div class="price-range-container" style="display: flex; align-items: center; gap: 10px;">
            <div class="price-label" style="font-weight: bold; color: #555;">Select Price Range:</div>
            <input
              type="range"
              id="priceRange"
              min="0"
              max="10000"
              value="{{ request.GET.price|default:0 }}"
              step="10"
              oninput="updatePriceDisplay(this.value)"
              style="width: 150px;"
            />
            <span id="priceDisplay" style="font-weight: bold; color: #007bff;">Rs.{{ request.GET.price|default:0 }}</span>
            <button
              type="button"
              class="btn btn-outline-primary"
              onclick="priceFilter(event)"
              style="border-color: #007bff; color: #007bff; padding: 5px 10px;"
            >
              Filter
            </button>
          </div>
          <!-- Filter Price block end -->
      
          <!-- Filter Capacity block -->
          <div class="price-range-container" style="display: flex; align-items: center; gap: 10px;">
            <div class="price-label" style="font-weight: bold; color: #555;">Select Room Capacity:</div>
            <select
              id="capacity"
              style="padding: 5px; border-radius: 5px; border: 1px solid #ddd;"
            >
              <option value="1" {% if request.GET.capacity == "1" %}selected{% endif %}>1</option>
              <option value="2" {% if request.GET.capacity == "2" %}selected{% endif %}>2</option>
              <option value="3" {% if request.GET.capacity == "3" %}selected{% endif %}>3</option>
              <option value="4" {% if request.GET.capacity == "4" %}selected{% endif %}>4</option>
            </select>
            <button
              class="btn btn-outline-primary"
              onclick="capacityFilter(event)"
              style="border-color: #007bff; color: #007bff; padding: 5px 10px;"
            >
              Filter
            </button>
          </div>
          <!-- Filter Capacity block end -->
      
          {% if is_filter %}
          <button 
          class="btn btn-outline-primary reset-filter-btn" 
          onclick="filterReset()" 
          style="border-color: #007bff; color: #007bff; padding: 5px 10px;">
          Reset Filter
        </button>
          {% endif %}
        </div>
      </div>



  
      <script>
        function getQueryParam(param){
          const urlParams = new URLSearchParams(window.location.search);
          return urlParams.get(param);
        }
        window.onload = function(){
          const initialPrice = getQueryParam("price");
          if (initialPrice) {
            document.getElementById("priceRange").value = initialPrice;
            updatePriceDisplay(initialPrice);
          }
        };

        function updatePriceDisplay(value) {
          document.getElementById("priceDisplay").innerText = 'Rs. ' + `${value}`;
        }
        function updatePriceDisplay(value) {
    const priceDisplay = document.getElementById('priceDisplay');
    priceDisplay.textContent = `Rs.${value}`;
  }

        function priceFilter(event) {
          const price = document.getElementById('priceRange').value;
          const urlParams = new URLSearchParams(window.location.search);
          urlParams.set('price', price);
          window.location.search = urlParams.toString();
        }

        function capacityFilter(event) {
          const capacity = document.getElementById('capacity').value;
          const urlParams = new URLSearchParams(window.location.search);
          urlParams.set('capacity', capacity); // Set capacity in the URL parameters
          window.location.search = urlParams.toString(); // Reload page with updated query
        }

        function filterReset() {
        // Clear all query parameters by resetting the URL
        const urlParams = new URLSearchParams(window.location.search);
        urlParams.delete('price');
        urlParams.delete('capacity');
        window.location.search = urlParams.toString(); // Reload page without filters
      }

  

      </script>



  
      {% if room_list %} 
        {% for room in room_list %}
        <div class="col-sm-6 col-md-4 col-lg-3 mb-4">
          <a href="/roomDetails/?room={{room.id}}" class="text-decoration-none" style="color: inherit;">
            <div class="card h-100" style="border: none; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); border-radius: 10px; overflow: hidden;">
              <img
                src="{{room.room_image1.url}}"
                alt="Room Image"
                style="width: 100%; height: 200px; object-fit: cover;"
              />
              <div class="card-body" style="padding: 15px;">
                <h5 class="card-title text-center" style="font-weight: bold; color: #333;">Room No: {{ room.room_number }}</h5>
                <div class="d-flex justify-content-between" style="margin-top: 10px;">
                  <p style="font-weight: bold; color: #007bff;">Rs: {{ room.price }} /-</p>
                  <p style="font-weight: bold; color: #555;">Capacity: {{ room.capacity }}</p>
                </div>
              </div>
            </div>
          </a>
        </div>
        {% endfor %} 
      {% else %}
        <div style="width: 100%; text-align: center;">
          <h5 style="color: red;">Rooms not available!</h5>
        </div>
      {% endif %}
    </div>
  </section>
  
</div>

{% endblock %}
